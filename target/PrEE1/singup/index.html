<!DOCTYPE html>
<html>
<head>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="/feed">HospitalLab</a>
    </nav>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>HospitalLab</title>
    <link rel="stylesheet" href="../resource/bootstrap-4.5.0-dist/css/bootstrap.min.css">
    <link href="../resource/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="p-4 soft-fluid">
    <div class="row shadow">
        <!-- Buying menu -->
        <div class="col-10 p-3 text-white items-category bg-secondary border border-dark rounded" id="menu-buy-units">
            <h3 class="text-dark">Регистрация:</h3>
            <form id="regForm" class="col-10 p-3" action="/feed" method="POST">
            <h4 class="text-dark">Данные аккаунта</h4>
                <div>
                    <label style="width:40%;">Логин*: </label>
                    <input id="login" type="text" name="nameNew">
                </div>
                <div>
                    <label style="width:40%;">Пароль*: </label>
                    <input id="pass1" type="password" name="passNew1"></div>
                <div>
                    <label style="width:40%;">Подтвердите пароль*: </label>
                    <input id="pass2" type="password" name="passNew2">
                    <label class="text-danger" id="warn1"></label>
                </div>
            <h4 class="text-dark">Уровень доступа</h4>
                <div>
                    <div>
                        <input type="radio" id="radio-staff" name="radio1" value="radio-staff"
                           onclick="updateSingupData()">
                        <label for="radio-staff">Сотрудник больницы</label>
                    </div>
                    <div>
                        <input type="radio" id="radio-patient" name="radio1" value="radio-patient"
                           checked onclick="updateSingupData()">
                        <label for="radio-patient">Пациент</label>
                    </div>
                </div>
                <script>
                    function checkSingupData() {
                        let pass1 = document.getElementById("pass1").value;
                        let pass2 = document.getElementById("pass2").value;
                        let login1 = document.getElementById("login").value;
                        let okFirst = false
                        if(pass1 !== pass2) {
                            document.getElementById("warn1").innerHTML = "Пароли должны совпадать!";
                        } else if(login1 === pass1) {
                            document.getElementById("warn1").innerHTML = "Пароль совпадает с логином!";
                        } else if(pass1.length < 6) {
                            document.getElementById("warn1").innerHTML = "Длина пароля меньше 6 символов!";
                        } else {
                            document.getElementById("warn1").innerHTML = "";
                            okFirst = true
                        }

                        if(login1.length < 1 || document.getElementById("inp1").value.length < 1 ||
                            document.getElementById("inp2").value.length < 1 ||
                            document.getElementById("inp3").value.length < 1 ||
                            ((document.getElementById("radio-patient").checked) &&
                            document.getElementById("inp_4").value.length < 1 ||
                            document.getElementById("inp_5").value.length < 1 ||
                            document.getElementById("inp_6").value.length < 1)) {
                            document.getElementById("warn2").innerHTML = "Не все поля заполнены";
                        } else {
                            document.getElementById("warn2").innerHTML = "";
                            if(okFirst) {
                                let form1 = document.getElementById("regForm")
                                form1.submit();
                            }
                        }
                    }

                    function updateSingupData() {
                        let strPrepared = "";
                        if (document.getElementById("radio-staff").checked){
                            strPrepared =
                                "\n<label style=\"width:40%;\">Должность*: </label>\n" +
                                "<input id=\"inp1\" type=\"text\" name=\"dataAccNew\">\n"
                            document.getElementById("problemInput").style.display = "none";
                        } else if (document.getElementById("radio-patient").checked){
                            strPrepared =
                                "\n<label style=\"width:40%;\">ОМС*: </label>\n" +
                                "<input id=\"inp1\" type=\"text\" name=\"dataAccNew\">\n"
                            document.getElementById("problemInput").style.display = "block";
                        }
                        document.getElementById("roleBasedHtml").innerHTML = strPrepared;
                    }
                </script>
            <h4 class="text-dark">Информация для регистрации</h4>
                <div>
                    <label style="width:40%;">Фамилия*: </label>
                    <input id="inp2" type="text" name="creds1New"></div>
                <div>
                    <label style="width:40%;">Имя*: </label>
                    <input id="inp3" type="text" name="creds2New">
                </div>
                <div>
                    <label style="width:40%;">Отчество: </label>
                    <input type="text" name="creds3New">
                </div>
                <div id="problemInput">
                    <div>
                        <label style="width:40%;">Причина обращения*: </label>
                        <input id="inp_4" type="text" name="problemNew">
                    </div>
                    <div>
                        <label style="width:40%;">Адрес*: </label>
                        <input id="inp_5" type="text" name="addressNew">
                    </div>
                    <div>
                        <label style="width:40%;">Email*: </label>
                        <input id="inp_6" type="text" name="emailNew">
                    </div>
                </div>
                <div id="roleBasedHtml">
                    <label style="width:40%;">ОМС*: </label>
                    <input id="inp1" type="text" name="dataAccNew" value="">
                </div>
                <div>
                    <input type="button" onclick="checkSingupData()" name="regButton" value="Отправить">
                    <label class="text-danger" id="warn2"></label>
                </div>
            </form>
        </div>
        <div class="row justify-content-center">
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
</body>
</html>

